2021-10-29 22:36:51 - dataprep - INFO - 
****** Running image validation ******

2021-10-29 22:36:52 - dataprep - INFO - 
****** Running samples validation ******

2021-10-29 22:36:52 - dataprep - INFO - Class distribution after validation:
2021-10-29 22:36:52 - dataprep - INFO - Cat: 1000 (50.0%)
2021-10-29 22:36:52 - dataprep - INFO - Dog: 1000 (50.0%)
2021-10-29 22:36:52 - dataprep - INFO - Class mapping:
{0: 'Cat', 1: 'Dog'}
2021-10-29 22:36:52 - dataprep - INFO - 
****** Creating train/val/test sets ******

2021-10-29 22:36:52 - dataprep - INFO - Split distribution: train: 0.65, val: 0.15, test: 0.2

2021-10-29 22:36:52 - dataprep - INFO - Partial split distribution: train: 0.65, val: 0.15, test: 0.20

2021-10-29 22:36:52 - dataprep - INFO - Train set:
2021-10-29 22:36:52 - dataprep - INFO - 0: 650 (50.0%)
2021-10-29 22:36:52 - dataprep - INFO - 1: 650 (50.0%)
2021-10-29 22:36:52 - dataprep - INFO - Val set:
2021-10-29 22:36:52 - dataprep - INFO - 0: 150 (50.0%)
2021-10-29 22:36:52 - dataprep - INFO - 1: 150 (50.0%)
2021-10-29 22:36:52 - dataprep - INFO - Test set:
2021-10-29 22:36:52 - dataprep - INFO - 0: 200 (50.0%)
2021-10-29 22:36:52 - dataprep - INFO - 1: 200 (50.0%)
2021-10-29 22:36:52 - dataprep - INFO - 
****** Resizing images ******

2021-10-29 22:36:55 - dataprep - INFO - Stored 2000 resized images under cats_and_dogs/train_resized
2021-10-29 22:36:55 - dataprep - INFO - Changed image directory to cats_and_dogs/train_resized
2021-10-29 22:42:43 - dataprep - INFO - 
****** Running image validation ******

2021-10-29 22:42:44 - dataprep - INFO - 
****** Running samples validation ******

2021-10-29 22:42:45 - dataprep - INFO - Class distribution after validation:
2021-10-29 22:42:45 - dataprep - INFO - Cat: 1000 (50.0%)
2021-10-29 22:42:45 - dataprep - INFO - Dog: 1000 (50.0%)
2021-10-29 22:42:45 - dataprep - INFO - Class mapping:
{0: 'Cat', 1: 'Dog'}
2021-10-29 22:42:45 - dataprep - INFO - 
****** Creating train/val/test sets ******

2021-10-29 22:42:45 - dataprep - INFO - Split distribution: train: 0.65, val: 0.15, test: 0.2

2021-10-29 22:42:45 - dataprep - INFO - Partial split distribution: train: 0.65, val: 0.15, test: 0.20

2021-10-29 22:42:45 - dataprep - INFO - Train set:
2021-10-29 22:42:45 - dataprep - INFO - 0: 650 (50.0%)
2021-10-29 22:42:45 - dataprep - INFO - 1: 650 (50.0%)
2021-10-29 22:42:45 - dataprep - INFO - Val set:
2021-10-29 22:42:45 - dataprep - INFO - 0: 150 (50.0%)
2021-10-29 22:42:45 - dataprep - INFO - 1: 150 (50.0%)
2021-10-29 22:42:45 - dataprep - INFO - Test set:
2021-10-29 22:42:45 - dataprep - INFO - 0: 200 (50.0%)
2021-10-29 22:42:45 - dataprep - INFO - 1: 200 (50.0%)
2021-10-29 22:42:45 - dataprep - INFO - 
****** Resizing images ******

2021-10-29 22:42:48 - dataprep - INFO - Stored 2000 resized images under cats_and_dogs/train_resized
2021-10-29 22:42:48 - dataprep - INFO - Changed image directory to cats_and_dogs/train_resized
2021-10-29 22:43:06 - training - INFO - Early stopping patience: 6
2021-10-29 22:43:06 - training - INFO - Learning rate patience: 2
2021-10-29 22:43:06 - training - INFO - 
****** Train dense layers ******

2021-10-29 22:43:59 - tf_keras - DEBUG - Epoch: 1 - val_loss: 0.1701 - val_acc: 0.9500 - loss: 0.8843 - acc: 0.6823
2021-10-29 22:43:59 - tf_keras - INFO - 
Epoch 00001 val_acc improved from -inf to 0.95000,
saving model to /Users/gohdong/Workspace/2021_autumn/AI+X/assignment2/sample_jobdir/models/model_mobilenet_01_0.950.hdf5
2021-10-29 22:44:56 - tf_keras - DEBUG - Epoch: 2 - val_loss: 0.1177 - val_acc: 0.9633 - loss: 0.5297 - acc: 0.8108 - lr: 0.0010
2021-10-29 22:44:56 - tf_keras - INFO - 
Epoch 00002 val_acc improved from 0.95000 to 0.96333,
saving model to /Users/gohdong/Workspace/2021_autumn/AI+X/assignment2/sample_jobdir/models/model_mobilenet_02_0.963.hdf5
2021-10-29 22:45:52 - tf_keras - DEBUG - Epoch: 3 - val_loss: 0.0980 - val_acc: 0.9700 - loss: 0.3361 - acc: 0.8762 - lr: 0.0010
2021-10-29 22:45:52 - tf_keras - INFO - 
Epoch 00003 val_acc improved from 0.96333 to 0.97000,
saving model to /Users/gohdong/Workspace/2021_autumn/AI+X/assignment2/sample_jobdir/models/model_mobilenet_03_0.970.hdf5
2021-10-29 22:45:52 - training - INFO - 
****** Train all layers ******

2021-10-29 22:49:30 - tf_keras - DEBUG - Epoch: 4 - val_loss: 0.1694 - val_acc: 0.9467 - loss: 0.2377 - acc: 0.9185
2021-10-29 22:49:30 - tf_keras - INFO - 
Epoch 00004 val_acc did not improve from 0.97000
2021-10-29 22:49:58 - evaluation - INFO - 
****** Load model ******

2021-10-29 22:50:02 - evaluation - INFO - loaded /Users/gohdong/Workspace/2021_autumn/AI+X/assignment2/sample_jobdir/models/model_mobilenet_03_0.970.hdf5
2021-10-29 22:50:11 - evaluation - INFO - 
****** Make prediction on test set ******

2021-10-29 22:50:24 - evaluation - INFO - 
****** Print distribution on test set ******

2021-10-29 22:50:24 - evaluation - INFO - Cat	200
2021-10-29 22:50:24 - evaluation - INFO - Dog	200
2021-10-29 22:50:24 - evaluation - INFO - 
****** Print classification report ******

2021-10-29 22:50:24 - evaluation - INFO -    	prec	rec	f1	support
2021-10-29 22:50:24 - evaluation - INFO - Cat	0.93	0.99	0.96	200	
2021-10-29 22:50:24 - evaluation - INFO - Dog	0.99	0.93	0.96	200	
2021-10-29 22:50:24 - evaluation - INFO - macro avg	0.96	0.96	0.96	400	
2021-10-29 22:50:24 - evaluation - INFO - weighted avg	0.96	0.96	0.96	400	
2021-10-29 22:50:24 - evaluation - INFO - 
****** Print confusion matrix (recall) ******

2021-10-29 22:50:24 - evaluation - INFO - Cat	0.99	0.01	
2021-10-29 22:50:24 - evaluation - INFO - Dog	0.07	0.93	
2021-10-29 22:50:24 - evaluation - INFO - 
****** Print confusion matrix (precision) ******

2021-10-29 22:50:24 - evaluation - INFO - Cat	0.93	0.07	
2021-10-29 22:50:24 - evaluation - INFO - Dog	0.01	0.99	
